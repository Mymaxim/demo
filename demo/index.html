<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="cache-control" content="no-cache">
        <meta name=viewport content="width=device-width, initial-scale=1">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <!-- <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" id="vp"/> -->
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
        <script type="text/javascript">
            (function(e,t){var i=document,n=window;var l=i.documentElement;var a,r;var d,s=document.createElement("style");var o;function m(){var i=l.getBoundingClientRect().width;if(!t){t=540}if(i>t){i=t}var n=i*100/e;s.innerHTML="html{font-size:"+n+"px;}"}a=i.querySelector('meta[name="viewport"]');r="width=device-width,initial-scale=1,maximum-scale=1.0,user-scalable=no,viewport-fit=cover";if(a){a.setAttribute("content",r)}else{a=i.createElement("meta");a.setAttribute("name","viewport");a.setAttribute("content",r);if(l.firstElementChild){l.firstElementChild.appendChild(a)}else{var c=i.createElement("div");c.appendChild(a);i.write(c.innerHTML);c=null}}m();if(l.firstElementChild){l.firstElementChild.appendChild(s)}else{var c=i.createElement("div");c.appendChild(s);i.write(c.innerHTML);c=null}n.addEventListener("resize",function(){clearTimeout(o);o=setTimeout(m,300)},false);n.addEventListener("pageshow",function(e){if(e.persisted){clearTimeout(o);o=setTimeout(m,300)}},false);if(i.readyState==="complete"){i.body.style.fontSize="16px"}else{i.addEventListener("DOMContentLoaded",function(e){i.body.style.fontSize="16px"},false)}})(750,750);
        </script>
        <title>demo</title>
        <!-- <link rel="icon" href="img/favicon.ico" mce_href="img/favicon.ico" type="image/x-icon"> -->
        <link rel="stylesheet" type="text/css" href="css/page.css" />
    </head>
    <body>
        <div class="content">
            <div class="box" id="loading">
                <div class="loader"></div>
            </div>
            <div id="pageTips"></div>
            <div class="c_header">banner or title</div>
            <div class="c_main">
                <div class="title_1"><img src="img/title_01.png" alt="" /></div>
                <div class="info">
                    <div class="u_name model1">
                        <div class="main_cont">
                            <label for="name">姓名或昵称：</label>
                            <div>
                                <input type="text" id="name"/>
                                <div id="name_right" class="right_tips"></div>
                            </div>
                        </div>
                        <div class="tips" id="name_tips"></div>
                    </div>
                    <div class="u_old model1">
                        <div class="main_cont">
                            <label for="old">年龄：</label>
                            <div>
                                <input type="number" id="old"/>
                                <div id="old_right" class="right_tips"></div>
                            </div>
                            <!-- <i>岁</i> -->
                        </div>
                        <div class="tips" id="old_tips"></div>
                    </div>
                    <div class="u_number model1">
                        <div class="main_cont">
                            <label for="number">联系电话：</label>
                            <div>
                                <input type="tel" id="number" maxlength ="11"/>
                                <div id="tel_right" class="right_tips"></div>
                            </div>
                        </div>
                        <div class="tips" id="number_tips"></div>
                    </div>
                    <div class="u_img model2">
                        <div class="main_cont">
                            <label for="img">参赛图片(小于5M)：</label>
                            <div>
                                <form id="form1" method="post" action="http://upload.qiniup.com" target="id_iframe1" enctype="multipart/form-data" style="display:none">
                                    <input id="key1" name="key" type="txt" value="">
                                    <input id="token1" name="token" type="txt" value="">
                                    <input id="img" name="file" type="file" />
                                    <input id="submitBtn1" type="submit" value="提交" />
                                </form>
                                <!-- <input type="file" id="img" style="display:none"/> -->
                                <span id="uploadImg" class="upload_icon" onclick="openFile('img')"><img id="id_img" src="img/upload_icon.png" alt="" /></span>
                                <div id="img_right" class="right_tips"></div>
                            </div>
                        </div>
                        <div class="tips" id="img_tips"></div>
                    </div>
                    <div class="u_video model2">
                        <div class="main_cont">
                            <label for="video">参赛视频(小于100M)：</label>
                            <div>
                                <form id="form2" method="post" action="http://upload.qiniup.com" target="id_iframe2" enctype="multipart/form-data" style="display:none">
                                    <input id="key2" name="key" type="txt" value="">
                                    <input id="token2" name="token" type="txt" value="">
                                    <input id="video" name="file" type="file" />
                                    <input id="submitBtn2" type="submit" value="提交" />
                                </form>
                                <!-- <input type="file" id="video" style="display:none"/> -->
                                <span id="uploadVideo" class="upload_icon" onclick="openFile('video')"><img id="video_img" src="img/upload_icon.png" alt="" /><video id="v_source" src="" style="display:none"></video><div id="_img" class="_img"></div></span>

                                <div id="video_right" class="right_tips"></div>
                            </div>
                        </div>
                        <div class="tips" id="video_tips"></div>
                    </div>
                    <div id="submit">提交</div>
                </div>
            </div>
            <div class="c_footer">
                <div class="title_2"><img src="img/title_02.png" alt="" /></div>
                <div class="rule"></div>
            </div>
        </div>
        <script src="./js/jquery.mim.js" type="text/javascript"></script>
        <script src="./js/jquery.form.js" type="text/javascript"></script>
        <script type="text/javascript">
            var videoType = ["wmv","asf","asx","rm"," rmvb","mp4","3gp","mov","m4v","avi","dat","mkv","flv","vob"];
            var imgType = ["jpg","png","jpeg"];
            var myreg = /^[1][3,4,5,6,7,8,9][0-9]{9}$/;

            function openFile(id) {
                $("#"+id).click();
            }

            $("#name").bind('input propertychange',function () {
                H("name_right");
                $("#name_tips").html("");
            })

            $("#name").blur(function(){
                if(!!this.value){
                    S("name_right");
                }else{
                    tips("name_tips","请填写姓名或昵称")
                }
            })

            $("#old").bind('input propertychange',function () {
                H("old_right");
                $("#old_tips").html("");
            })

            $("#old").blur(function(){
                if(!!this.value){
                    S("old_right");
                }else{
                    tips("old_tips","请填写年龄")
                }
            })

            $("#number").bind('input propertychange',function () {
                H("tel_right");
                $("#number_tips").html("");
                if(myreg.test(this.value) && this.value.length ==11){
                    S("tel_right");
                }
            })

            $("#number").blur(function(){
                if(!this.value){
                    tips("number_tips","请填写联系电话")
                }else if(!myreg.test(this.value)){
                    tips("number_tips","手机号码格式有误！")
                }else if(myreg.test(this.value)){
                    S("tel_right");
                }
            })


            $("#img").on("change",function () {
                var fileObj = this.files[0];
                var fileReader = new FileReader();
                var type = this.value.toLowerCase().split('.').splice(-1)[0];
                if(type != "png" && type != "jpg" && type != "jpeg"){
                    tips("img_tips","图片格式有误，请重新上传！支持.jpg,.png,.jpeg格式")
                    return;
                }else if(this.files[0].size>5*1024*1024){
                    tips("img_tips","图片文件过大，请压缩后再上传！")
                    return;
                }else if((type == "png" || type == "jpg" || type == "jpeg")&&this.files[0].size<=5*1024*1024){
                    S("img_right");
                    $("#img_tips").html("");
                }
                fileReader.readAsDataURL(fileObj);
                fileReader.onload = function () {
                    $("#id_img").src = fileReader.result;
                }
            });

            $("#video").on("change",function (){
                var fileObj = this.files[0];
                var fileReader = new FileReader();
                if(fileObj.size>100*1024*1024){
                    tips("video_tips","图片文件过大，请压缩后再上传！")
                    return;
                }else if(this.files[0].size<=100*1024*1024){
                    S("video_right");
                    S("_img");
                    $("#video_tips").html("");
                }
                fileReader.readAsDataURL(fileObj);
                fileReader.onload = function () {
                    $("#video_img").style.display = "none";
                    $("#v_source").style.display = "block";
                    $("#v_source").src = fileReader.result;
                }
            })

            $("#submit").on("click",function(){
                $("#loading").stop(true,false).fadeIn(2000).fadeOut(800);
                $("#pageTips").html("提交成功").stop(true,false).fadeIn(2000).fadeOut(800);
            })

            $(document).ready(function() {
                $("#form1").ajaxForm(function(data){
                    if(data.code == 0){
                        fileData1 = data.data.filename;
                    }
                });
                $("#form2").ajaxForm(function(data){
                    if(data.code == 0){
                        fileData2 = data.data.filename;
                    }
                });

                return false;
            });


            function S(id) {
              $("#"+id).css('visibility','visible');
            }

            function H(id) {
              $("#"+id).css('visibility','hidden');
            }

            function tips(id,txt) {
              txt = txt || "请按要求填写或提交";
              $("#"+id).html("* " + txt);
            }

            function clearTxt(id){
                $("#"+id).html("");
            }
        </script>
    </body>
</html>
